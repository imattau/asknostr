# Specification: Fix Missing Posts in Community Feeds\n\n## Overview\nThis track addresses a critical bug where community feeds appear empty across all communities, even though the same events are successfully received and displayed in the Global feed. This indicates that either the subscription filters sent to relays for community-specific views are malformed, or the client-side logic that filters these events into their respective community buckets is failing.\n\n## Problem Analysis\n- **Subscription Filters:** The client likely uses an 'a' tag filter (Kind 34550) to fetch community posts. If these filters are incorrect, relays won't return events.\n- **Tag Matching Logic:** When events arrive, they must match the current community's unique identifier. A mismatch in how tags are parsed or compared would lead to empty feeds.\n\n## Functional Requirements\n- **Correct Subscription Filtering:** Ensure that 'useCommunity' and related hooks generate valid Nostr filters that include the correct 'a' tag for the community.\n- **Robust Tag Parsing:** Fix the logic that identifies an event's community association to handle various tag formats consistently.\n- **State Synchronization:** Ensure that the 'VirtualFeed' correctly receives and displays events once they pass the community filter.\n\n## Non-Functional Requirements\n- **Reliability:** Feeds should consistently load content across different relays and communities.\n- **Auditability:** Log filtering decisions to help diagnose why a specific event was included or excluded from a feed.\n\n## Acceptance Criteria\n- Navigating to any community feed displays relevant posts.\n- Posts correctly show up in the community feed if they contain the matching 'a' tag.\n- The "Global" feed and "Community" feeds remain consistent (an event in Global with a community tag should appear in that community's feed).\n\n## Out of Scope\n- Fixing issues with the Global feed itself.\n- Moderation logic (handled in a separate track if needed).
