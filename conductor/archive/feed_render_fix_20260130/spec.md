# Specification: Fix VirtualFeed Rendering Glitches\n\n## Overview\nThis track addresses a critical bug in the 'VirtualFeed' component where posts overlap ("sit on top of each other"). This occurs primarily when new content is appended to the feed (Load More) or when posts contain asynchronous media (images/videos) that change the rendered height of a row after its initial measurement.\n\n## Problem Analysis\n- **Virtualized Measurement:** The 'VirtualFeed' (using 'react-window') relies on fixed or pre-calculated row heights. If a post's content expands (e.g., an image loads), the virtual list may not be aware of the new height, leading to overlapping.\n- **State Synchronization:** During "Load More" operations, the list's internal cache or index might be getting out of sync with the new event data.\n\n## Functional Requirements\n- **Dynamic Height Re-measurement:** Implement a mechanism to force the virtual list to re-calculate row heights when media components (images/videos) within a 'Post' finish loading.\n- **Stable Indexing:** Ensure that appending new events to the list correctly updates the virtual scroll container without causing visual jumps or overlaps.\n- **Key Stability:** Verify that the 'itemKey' generated for rows is unique and stable to prevent unnecessary re-renders or state loss.\n\n## Non-Functional Requirements\n- **Performance:** Maintain smooth scrolling (60fps) even during re-measurements.\n- **Memory Efficiency:** Avoid excessive re-renders of the entire list.\n\n## Acceptance Criteria\n- Posts never visually overlap, regardless of content type.\n- The feed correctly adjusts row spacing as images and videos load.\n- Clicking "Load More" seamlessly appends content without causing layout corruption.\n\n## Out of Scope\n- Redesigning the visual style of the 'Post' component.\n- Implementing a different virtualization library (unless 'react-window' proves fundamentally incapable of supporting dynamic heights in this context).
